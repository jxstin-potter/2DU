import{r as l,A as e,H as n,a6 as D,T as c,V as E,bd as b}from"./vendor-Ch348d4r.js";import{u as T}from"./index-DR31qAIW.js";import{s as S,a as w}from"./tasksService-BrK5NF1i.js";import{e as f,D as M,ab as k,ac as C}from"./utils-BdZxPcI9.js";const z=({task:a})=>{const{user:o}=T(),m=l.useMemo(()=>a.updatedAt?f(new Date(a.updatedAt),"h:mm a"):"",[a.updatedAt]),p=l.useMemo(()=>o!=null&&o.name?o.name.split(" ").map(y=>y[0]).join("").toUpperCase().slice(0,2):"U",[o==null?void 0:o.name]);return e.jsx(n,{component:"div",sx:{textDecoration:"none",color:"inherit",display:"block",cursor:"pointer","&:hover":{backgroundColor:"action.hover"}},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1.5,py:1.5,px:2,borderBottom:"1px solid",borderColor:"divider"},children:[e.jsx(D,{sx:{width:24,height:24,fontSize:"0.75rem",bgcolor:"primary.main"},children:p}),e.jsxs(n,{sx:{flex:1,display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(c,{variant:"body2",sx:{color:"text.secondary",fontSize:"0.875rem"},children:"You completed"}),e.jsx(n,{sx:{width:16,height:16,borderRadius:"50%",border:"2px solid",borderColor:"error.main",flexShrink:0}}),e.jsx(c,{variant:"body2",sx:{textDecoration:"line-through",color:"text.secondary",fontSize:"0.875rem",flex:1},children:a.title}),e.jsx(c,{variant:"body2",sx:{color:"text.secondary",fontSize:"0.875rem"},children:"No project"}),e.jsx(c,{variant:"body2",sx:{color:"text.secondary",fontSize:"0.875rem"},children:m})]})]})})},N=()=>{const a=E(),{user:o}=T(),[m,p]=l.useState([]),[y,h]=l.useState(!0),[A,g]=l.useState(null);l.useEffect(()=>{if(!(o!=null&&o.id)){p([]),h(!1);return}h(!0),g(null);const s=S(o.id,{completionStatus:"all",sortBy:"creationDate",sortOrder:"desc"},i=>{try{const t=i.tasks.map(d=>w(d)).filter(d=>d.completed===!0).sort((d,u)=>{const v=d.updatedAt?new Date(d.updatedAt).getTime():0;return(u.updatedAt?new Date(u.updatedAt).getTime():0)-v});p(t),h(!1),g(null)}catch(r){g("Failed to process tasks"),h(!1)}});return()=>{s()}},[o==null?void 0:o.id]);const x=l.useMemo(()=>{const s={};return m.forEach(i=>{if(!i.updatedAt)return;const r=M(new Date(i.updatedAt));let t;k(r)?t=f(r,"MMM d 'Today' ‧ EEEE"):C(r)?t=f(r,"MMM d 'Yesterday' ‧ EEEE"):t=f(r,"MMM d ‧ EEEE"),s[t]||(s[t]=[]),s[t].push(i)}),Object.keys(s).forEach(i=>{s[i].sort((r,t)=>{const d=r.updatedAt?new Date(r.updatedAt).getTime():0;return(t.updatedAt?new Date(t.updatedAt).getTime():0)-d})}),s},[m]),j=l.useMemo(()=>Object.keys(x).sort((s,i)=>{const r=x[s][0],t=x[i][0];if(!(r!=null&&r.updatedAt)||!(t!=null&&t.updatedAt))return 0;const d=new Date(r.updatedAt).getTime();return new Date(t.updatedAt).getTime()-d}),[x]);return y?e.jsx(b,{maxWidth:"lg",children:e.jsx(n,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:e.jsx(c,{children:"Loading..."})})}):A?e.jsx(b,{maxWidth:"lg",children:e.jsx(n,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:e.jsx(c,{color:"error",children:A})})}):e.jsx(n,{sx:{display:"flex",justifyContent:"center",alignItems:"flex-start",width:"100%",px:{xs:2,sm:0}},children:e.jsx(b,{maxWidth:"md",disableGutters:!0,sx:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},children:e.jsxs(n,{sx:{width:"100%",maxWidth:{xs:"100%",sm:a.breakpoints.values.sm}},children:[e.jsx(n,{sx:{mb:3},children:e.jsx(c,{variant:"h5",component:"h1",sx:{fontWeight:a.typography.fontWeightBold,mb:1},children:"Activity: All projects"})}),j.length>0?j.map(s=>e.jsxs(n,{sx:{mb:4},children:[e.jsx(c,{variant:"h6",sx:{fontWeight:a.typography.fontWeightBold,fontSize:a.typography.body1.fontSize,mb:2,color:"text.secondary"},children:s}),e.jsx(n,{sx:{bgcolor:"background.paper",borderRadius:1,overflow:"hidden"},children:x[s].map(i=>e.jsx(z,{task:i},i.id))})]},s)):e.jsx(n,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"200px"},children:e.jsx(c,{variant:"body2",color:"text.secondary",sx:{fontSize:a.typography.body2.fontSize},children:"No completed tasks yet"})}),j.length>0&&e.jsx(n,{sx:{display:"flex",justifyContent:"center",mt:4,mb:4},children:e.jsx(c,{variant:"body2",color:"text.secondary",sx:{fontSize:a.typography.body2.fontSize,fontStyle:"italic"},children:"That's it. No more history to load."})})]})})})};export{N as default};
