var ae=Object.defineProperty,se=Object.defineProperties;var ne=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var D=(a,n,s)=>n in a?ae(a,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[n]=s,z=(a,n)=>{for(var s in n||(n={}))re.call(n,s)&&D(a,s,n[s]);if(T)for(var s of T(n))ie.call(n,s)&&D(a,s,n[s]);return a},M=(a,n)=>se(a,ne(n));var C=(a,n,s)=>new Promise((j,o)=>{var u=c=>{try{r(s.next(c))}catch(x){o(x)}},h=c=>{try{r(s.throw(c))}catch(x){o(x)}},r=c=>c.done?j(c.value):Promise.resolve(c.value).then(u,h);r((s=s.apply(a,n)).next())});import{W as oe,Q as N,r as p,A as e,P as le,aW as R,H as y,T as b,K as k,aX as ce,aY as de,af as ue,I as B,aZ as pe,at as he,a_ as me,a$ as S,N as G,ai as xe,aj as ge,al as fe,ar as O,av as be,R as ye,h as q}from"./vendor-CbdQs_1R.js";import{u as _}from"./index-B5I4Nid2.js";import"./utils-BuwBnmRf.js";const L=pe(O)(({theme:a})=>({marginBottom:"16px","& .MuiInputBase-root":{position:"relative",minHeight:"56px"},"& .MuiInputBase-input":{padding:"16px 14px","&:-webkit-autofill":{WebkitBoxShadow:a.palette.mode==="dark"?"0 0 0 100px #333 inset":"0 0 0 100px #f5f5f5 inset",WebkitTextFillColor:a.palette.text.primary,caretColor:a.palette.primary.main,borderRadius:"inherit",transition:"background-color 5000s ease-in-out 0s, color 5000s ease-in-out 0s"}},"& .MuiInputLabel-root":{"&.MuiFormLabel-filled":{transform:"translate(14px, -9px) scale(0.75)"},transition:a.transitions.create(["transform","color"],{duration:a.transitions.duration.shorter,easing:a.transitions.easing.easeOut})},"& .MuiInputBase-input:-webkit-autofill + .MuiInputLabel-root":{transform:"translate(14px, -9px) scale(0.75)",color:a.palette.primary.main}})),je=()=>{const{login:a,signup:n,loginWithGoogle:s,loginWithApple:j,requestPasswordReset:o}=_(),u=oe(),h=N(),[r,c]=p.useState(!0),[x,i]=p.useState(null),[F,f]=p.useState(null),[d,g]=p.useState(!1),[v,H]=p.useState(!0),[U,W]=p.useState(!1),[$,A]=p.useState(""),[l,K]=p.useState({email:"",password:"",name:""}),I=p.useMemo(()=>{var m,w,E;const t=(m=h.state)==null?void 0:m.from;if(t!=null&&t.pathname){const ee=(w=t.search)!=null?w:"",te=(E=t.hash)!=null?E:"";return`${t.pathname}${ee}${te}`}return"/today"},[h.state]),Q=()=>{const t=l.email.trim();return!t||!l.password?(i("Please fill in all required fields"),!1):!r&&!l.name?(i("Please enter your name"),!1):/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?l.password.length<6?(i("Password must be at least 6 characters long"),!1):!0:(i("Please enter a valid email address"),!1)},X=t=>C(void 0,null,function*(){if(t.preventDefault(),i(null),f(null),!!Q()){g(!0);try{r?yield a(l.email,l.password,v):yield n(l.email,l.password,l.name,v),u(I,{replace:!0})}catch(m){i(m instanceof Error?m.message:"An error occurred")}finally{g(!1)}}}),Y=()=>C(void 0,null,function*(){i(null),f(null),g(!0);try{(yield s(v))==="success"&&u(I,{replace:!0})}catch(t){i(t instanceof Error?t.message:"Google sign-in failed")}finally{g(!1)}}),Z=()=>C(void 0,null,function*(){i(null),f(null),g(!0);try{(yield j(v))==="success"&&u(I,{replace:!0})}catch(t){i(t instanceof Error?t.message:"Apple sign-in failed")}finally{g(!1)}}),P=t=>{K(m=>M(z({},m),{[t.target.name]:t.target.value})),i(null),f(null)},J=()=>{i(null),f(null),A(l.email.trim()),W(!0)},V=()=>C(void 0,null,function*(){i(null),f(null);const t=$.trim();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)){i("Please enter a valid email address");return}g(!0);try{yield o(t),W(!1),f("If an account exists for that email, you'll receive a password reset link shortly. If you usually sign in with Google, sign in with Google and add a password in Settings.")}catch(w){i(w instanceof Error?w.message:"Failed to send password reset email")}finally{g(!1)}});return e.jsxs(le,{elevation:0,sx:{p:{xs:3,sm:4},width:"100%",maxWidth:380,borderRadius:3,border:t=>`1px solid ${t.palette.divider}`,bgcolor:"background.paper"},children:[e.jsxs(R,{spacing:2.25,children:[e.jsx(y,{sx:{display:"flex",justifyContent:"center"},children:e.jsx(y,{"aria-label":"2DU",sx:{width:44,height:44,borderRadius:2,bgcolor:"#000",color:"#fff",display:"grid",placeItems:"center",fontWeight:800,letterSpacing:"-0.03em",userSelect:"none"},children:"2DU"})}),e.jsxs(y,{children:[e.jsx(b,{component:"h1",variant:"h5",align:"center",sx:{fontWeight:800},children:r?"Welcome!":"Create your account"}),e.jsx(b,{variant:"body2",align:"center",color:"text.secondary",sx:{mt:.5},children:r?"Log in to start completing tasks.":"Sign up to start completing tasks."})]}),e.jsxs(R,{spacing:1,children:[e.jsx(k,{fullWidth:!0,variant:"outlined",size:"large",startIcon:e.jsx(ce,{}),onClick:Y,disabled:d,sx:{borderRadius:2,textTransform:"none"},children:"Continue with Google"}),e.jsx(k,{fullWidth:!0,variant:"outlined",size:"large",startIcon:e.jsx(de,{}),onClick:Z,disabled:d,sx:{borderRadius:2,textTransform:"none"},children:"Continue with Apple"})]}),e.jsx(ue,{sx:{color:"text.secondary"},children:"OR"}),x&&e.jsx(B,{severity:"error",children:x}),F&&e.jsx(B,{severity:"success",children:F}),e.jsx(y,{component:"form",onSubmit:X,autoComplete:"on",children:e.jsxs(R,{spacing:1.5,children:[!r&&e.jsx(L,{fullWidth:!0,label:"Name",name:"name",value:l.name,onChange:P,required:!0,disabled:d,variant:"outlined",autoComplete:"name",inputProps:{autoCapitalize:"words"}}),e.jsx(L,{fullWidth:!0,label:"Email",name:"email",type:"email",value:l.email,onChange:P,required:!0,disabled:d,variant:"outlined",autoComplete:"email",inputProps:{autoCapitalize:"none",spellCheck:"false"}}),e.jsx(L,{fullWidth:!0,label:"Password",name:"password",type:"password",value:l.password,onChange:P,required:!0,disabled:d,variant:"outlined",autoComplete:r?"current-password":"new-password"}),e.jsxs(R,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{mt:.25},children:[e.jsx(he,{control:e.jsx(me,{checked:v,onChange:t=>H(t.target.checked),size:"small"}),label:e.jsx(b,{variant:"body2",children:"Remember me"})}),e.jsx(S,{component:"button",type:"button",onClick:J,underline:"hover",sx:{fontSize:"0.875rem"},disabled:!r||d,children:"Forgot password?"})]}),e.jsx(k,{type:"submit",fullWidth:!0,variant:"contained",size:"large",sx:{mt:.5,borderRadius:2,textTransform:"none",fontWeight:700},disabled:d,children:d?e.jsx(G,{size:22,color:"inherit"}):r?"Log in":"Sign up"})]})}),e.jsx(b,{variant:"body2",color:"text.secondary",align:"center",children:r?e.jsxs(e.Fragment,{children:["Don't have an account?"," ",e.jsx(S,{component:"button",type:"button",onClick:()=>c(!1),underline:"hover",sx:{fontWeight:700},children:"Sign up"})]}):e.jsxs(e.Fragment,{children:["Already have an account?"," ",e.jsx(S,{component:"button",type:"button",onClick:()=>c(!0),underline:"hover",sx:{fontWeight:700},children:"Log in"})]})})]}),e.jsxs(xe,{open:U,onClose:()=>W(!1),"aria-labelledby":"reset-password-title",fullWidth:!0,maxWidth:"xs",children:[e.jsx(ge,{id:"reset-password-title",children:"Reset password"}),e.jsxs(fe,{sx:{pt:1},children:[e.jsx(b,{variant:"body2",color:"text.secondary",sx:{mb:1.5},children:"Enter your email and we'll send you a reset link."}),e.jsx(O,{autoFocus:!0,fullWidth:!0,label:"Email",type:"email",value:$,onChange:t=>A(t.target.value),disabled:d,autoComplete:"email",inputProps:{autoCapitalize:"none",spellCheck:"false"}})]}),e.jsxs(be,{sx:{px:3,pb:2},children:[e.jsx(k,{onClick:()=>W(!1),disabled:d,children:"Cancel"}),e.jsx(k,{variant:"contained",onClick:V,disabled:d,children:d?e.jsx(G,{size:20,color:"inherit"}):"Send reset link"})]})]})]})},Se=()=>{const{user:a,loading:n}=_(),s=N(),j=p.useMemo(()=>{var u,h,r;const o=(u=s.state)==null?void 0:u.from;if(o!=null&&o.pathname){const c=(h=o.search)!=null?h:"",x=(r=o.hash)!=null?r:"";return`${o.pathname}${c}${x}`}return"/today"},[s.state]);return!n&&a?e.jsx(ye,{to:j,replace:!0}):e.jsx(y,{component:"main",sx:{height:"100dvh",display:"flex",alignItems:"center",justifyContent:"center",px:2,py:3,overflow:"hidden",bgcolor:"background.default",backgroundImage:o=>{const u=q(o.palette.primary.main,.14),h=q(o.palette.primary.main,.08);return`radial-gradient(1200px circle at 20% 10%, ${u}, transparent 40%), radial-gradient(900px circle at 90% 80%, ${h}, transparent 40%)`}},children:e.jsxs(y,{sx:{width:"100%",maxWidth:420},children:[e.jsx(je,{}),e.jsxs(b,{variant:"caption",color:"text.secondary",sx:{display:"block",textAlign:"center",mt:2},children:["By continuing you agree to our"," ",e.jsx(S,{href:"#",underline:"hover",color:"inherit",children:"Terms"})," ","and"," ",e.jsx(S,{href:"#",underline:"hover",color:"inherit",children:"Privacy Policy"}),"."]})]})})};export{Se as default};
